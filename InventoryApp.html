<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Inventory Management System</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        .dropdown-menu {
            position: relative;
        }
    </style>
</head>
<body class="bg-gray-50">
    <div id="app" class="min-h-screen p-6">
        <div class="max-w-7xl mx-auto">
            <div class="bg-white rounded-lg shadow-lg overflow-hidden">
                <!-- Header -->
                <div class="bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-8">
                    <div class="flex items-center justify-between">
                        <div class="flex items-center space-x-3">
                            <svg class="text-white w-8 h-8" fill="currentColor" viewBox="0 0 24 24">
                                <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2z"/>
                                <path d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"/>
                            </svg>
                            <h1 class="text-3xl font-bold text-white">Inventory Manager</h1>
                        </div>
                        <div class="flex items-center space-x-3">
                            <!-- Import Button -->
                            <div class="relative dropdown-menu">
                                <button onclick="toggleImportMenu()" class="bg-green-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-600 transition-colors flex items-center space-x-2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                        <polyline points="14,2 14,8 20,8"/>
                                        <line x1="12" y1="18" x2="12" y2="12"/>
                                        <polyline points="9,15 12,12 15,15"/>
                                    </svg>
                                    <span>Import</span>
                                </button>
                                <div id="importMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-50">
                                    <label class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer">
                                        <input type="file" accept=".json" onchange="importFromJSON(event)" class="hidden">
                                        Import from JSON
                                    </label>
                                    <label class="block px-4 py-2 text-gray-700 hover:bg-gray-100 cursor-pointer border-t">
                                        <input type="file" accept=".csv" onchange="importFromCSV(event)" class="hidden">
                                        Import from CSV
                                    </label>
                                </div>
                            </div>
                            
                            <!-- Export Button -->
                            <div class="relative dropdown-menu">
                                <button onclick="toggleExportMenu()" class="bg-indigo-500 text-white px-4 py-2 rounded-lg font-medium hover:bg-indigo-600 transition-colors flex items-center space-x-2">
                                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                                        <polyline points="7,10 12,15 17,10"/>
                                        <line x1="12" y1="15" x2="12" y2="3"/>
                                    </svg>
                                    <span>Export</span>
                                </button>
                                <div id="exportMenu" class="hidden absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-lg border z-50">
                                    <button onclick="exportToCSV(); toggleExportMenu()" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                                <polyline points="14,2 14,8 20,8"/>
                                                <line x1="16" y1="13" x2="8" y2="13"/>
                                                <line x1="16" y1="17" x2="8" y2="17"/>
                                                <polyline points="10,9 9,9 8,9"/>
                                            </svg>
                                            <span>Export as CSV</span>
                                        </div>
                                    </button>
                                    <button onclick="exportToJSON(); toggleExportMenu()" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 border-t">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                                <polyline points="14,2 14,8 20,8"/>
                                                <line x1="16" y1="13" x2="8" y2="13"/>
                                                <line x1="16" y1="17" x2="8" y2="17"/>
                                                <polyline points="10,9 9,9 8,9"/>
                                            </svg>
                                            <span>Export as JSON</span>
                                        </div>
                                    </button>
                                    <button onclick="exportToExcel(); toggleExportMenu()" class="block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 border-t">
                                        <div class="flex items-center space-x-2">
                                            <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                                                <polyline points="14,2 14,8 20,8"/>
                                                <line x1="16" y1="13" x2="8" y2="13"/>
                                                <line x1="16" y1="17" x2="8" y2="17"/>
                                                <polyline points="10,9 9,9 8,9"/>
                                            </svg>
                                            <span>Export as Excel</span>
                                        </div>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Add Product Button -->
                            <button onclick="toggleAddProduct()" class="bg-white text-blue-600 px-4 py-2 rounded-lg font-medium hover:bg-gray-100 transition-colors flex items-center space-x-2">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <line x1="12" y1="5" x2="12" y2="19"/>
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                </svg>
                                <span>Add Product</span>
                            </button>
                        </div>
                    </div>
                    <p class="text-blue-100 mt-2">Manage inventory across multiple sales platforms</p>
                </div>

                <!-- Content -->
                <div class="p-6">
                    <!-- Add Product Form -->
                    <div id="addProductForm" class="hidden bg-gray-50 rounded-lg p-6 mb-6 border-2 border-dashed border-gray-300">
                        <h3 class="text-lg font-semibold mb-4">Add New Product</h3>
                        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-4">
                            <input type="text" id="newProductName" placeholder="Product Name" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="text" id="newProductSku" placeholder="SKU" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="number" id="newProductQuantity" placeholder="Quantity" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <input type="number" id="newProductPrice" step="0.01" placeholder="Price" class="border rounded-lg px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>
                        <div class="flex space-x-3">
                            <button onclick="addProduct()" class="bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors">Add Product</button>
                            <button onclick="toggleAddProduct()" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600 transition-colors">Cancel</button>
                        </div>
                    </div>

                    <!-- Products List -->
                    <div id="productsList" class="space-y-6">
                        <!-- Products will be rendered here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let products = [
            {
                id: 1,
                name: "Vintage Leather Wallet",
                sku: "VLW001",
                quantity: 25,
                price: 45.99,
                platforms: {
                    ebay: { listed: true, quantity: 10, lastSync: "2025-08-11 10:30" },
                    etsy: { listed: true, quantity: 8, lastSync: "2025-08-11 10:25" },
                    amazon: { listed: false, quantity: 0, lastSync: null },
                    shopify: { listed: true, quantity: 7, lastSync: "2025-08-11 10:35" }
                }
            },
            {
                id: 2,
                name: "Handmade Ceramic Mug",
                sku: "HCM002",
                quantity: 15,
                price: 28.50,
                platforms: {
                    ebay: { listed: false, quantity: 0, lastSync: null },
                    etsy: { listed: true, quantity: 12, lastSync: "2025-08-11 09:15" },
                    amazon: { listed: true, quantity: 3, lastSync: "2025-08-11 09:20" },
                    shopify: { listed: false, quantity: 0, lastSync: null }
                }
            }
        ];

        let syncStatus = {};

        const platformColors = {
            ebay: 'bg-blue-100 text-blue-800',
            etsy: 'bg-orange-100 text-orange-800',
            amazon: 'bg-yellow-100 text-yellow-800',
            shopify: 'bg-green-100 text-green-800'
        };

        // Load data from localStorage on startup
        function loadData() {
            const savedData = localStorage.getItem('inventoryData');
            if (savedData) {
                products = JSON.parse(savedData);
            }
            renderProducts();
        }

        // Save data to localStorage
        function saveData() {
            localStorage.setItem('inventoryData', JSON.stringify(products));
        }

        // Get total listed quantity for a product
        function getTotalListedQuantity(product) {
            return Object.values(product.platforms).reduce((sum, platform) => 
                sum + (platform.listed ? platform.quantity : 0), 0
            );
        }

        // Get available quantity for a product
        function getAvailableQuantity(product) {
            return product.quantity - getTotalListedQuantity(product);
        }

        // Toggle menus
        function toggleExportMenu() {
            const menu = document.getElementById('exportMenu');
            menu.classList.toggle('hidden');
            document.getElementById('importMenu').classList.add('hidden');
        }

        function toggleImportMenu() {
            const menu = document.getElementById('importMenu');
            menu.classList.toggle('hidden');
            document.getElementById('exportMenu').classList.add('hidden');
        }

        function toggleAddProduct() {
            const form = document.getElementById('addProductForm');
            form.classList.toggle('hidden');
        }

        // Close menus when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.dropdown-menu')) {
                document.getElementById('exportMenu').classList.add('hidden');
                document.getElementById('importMenu').classList.add('hidden');
            }
        });

        // Add new product
        function addProduct() {
            const name = document.getElementById('newProductName').value;
            const sku = document.getElementById('newProductSku').value;
            const quantity = parseInt(document.getElementById('newProductQuantity').value) || 0;
            const price = parseFloat(document.getElementById('newProductPrice').value) || 0;

            if (name && sku) {
                const newProduct = {
                    id: Math.max(...products.map(p => p.id), 0) + 1,
                    name,
                    sku,
                    quantity,
                    price,
                    platforms: {
                        ebay: { listed: false, quantity: 0, lastSync: null },
                        etsy: { listed: false, quantity: 0, lastSync: null },
                        amazon: { listed: false, quantity: 0, lastSync: null },
                        shopify: { listed: false, quantity: 0, lastSync: null }
                    }
                };
                
                products.push(newProduct);
                saveData();
                renderProducts();
                
                // Clear form
                document.getElementById('newProductName').value = '';
                document.getElementById('newProductSku').value = '';
                document.getElementById('newProductQuantity').value = '';
                document.getElementById('newProductPrice').value = '';
                toggleAddProduct();
            }
        }

        // Update product quantity
        function updateQuantity(productId, newQuantity) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.quantity = Math.max(0, newQuantity);
                saveData();
                renderProducts();
            }
        }

        // Toggle platform listing
        function togglePlatformListing(productId, platform) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.platforms[platform].listed = !product.platforms[platform].listed;
                if (!product.platforms[platform].listed) {
                    product.platforms[platform].quantity = 0;
                }
                saveData();
                renderProducts();
            }
        }

        // Update platform quantity
        function updatePlatformQuantity(productId, platform, quantity) {
            const product = products.find(p => p.id === productId);
            if (product) {
                product.platforms[platform].quantity = Math.max(0, quantity);
                saveData();
                renderProducts();
            }
        }

        // Sync to platform
        function syncToPlatform(productId, platform) {
            const syncKey = `${productId}-${platform}`;
            syncStatus[syncKey] = 'syncing';
            renderProducts();

            setTimeout(() => {
                const product = products.find(p => p.id === productId);
                if (product && product.platforms[platform].listed) {
                    product.platforms[platform].lastSync = new Date().toLocaleString('en-US', {
                        year: 'numeric',
                        month: '2-digit',
                        day: '2-digit',
                        hour: '2-digit',
                        minute: '2-digit'
                    });
                    syncStatus[syncKey] = 'success';
                    saveData();
                    renderProducts();
                    
                    setTimeout(() => {
                        delete syncStatus[syncKey];
                        renderProducts();
                    }, 2000);
                }
            }, 1500);
        }

        // Sync all platforms for a product
        function syncAllPlatforms(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                Object.keys(product.platforms).forEach(platform => {
                    if (product.platforms[platform].listed) {
                        syncToPlatform(productId, platform);
                    }
                });
            }
        }

        // Export functions
        function exportToCSV() {
            const csvData = products.map(product => ({
                ID: product.id,
                Name: product.name,
                SKU: product.sku,
                'Total Quantity': product.quantity,
                Price: product.price,
                'Available Quantity': getAvailableQuantity(product),
                'eBay Listed': product.platforms.ebay.listed ? 'Yes' : 'No',
                'eBay Quantity': product.platforms.ebay.quantity,
                'eBay Last Sync': product.platforms.ebay.lastSync || 'Never',
                'Etsy Listed': product.platforms.etsy.listed ? 'Yes' : 'No',
                'Etsy Quantity': product.platforms.etsy.quantity,
                'Etsy Last Sync': product.platforms.etsy.lastSync || 'Never',
                'Amazon Listed': product.platforms.amazon.listed ? 'Yes' : 'No',
                'Amazon Quantity': product.platforms.amazon.quantity,
                'Amazon Last Sync': product.platforms.amazon.lastSync || 'Never',
                'Shopify Listed': product.platforms.shopify.listed ? 'Yes' : 'No',
                'Shopify Quantity': product.platforms.shopify.quantity,
                'Shopify Last Sync': product.platforms.shopify.lastSync || 'Never'
            }));

            const csvContent = [
                Object.keys(csvData[0]).join(','),
                ...csvData.map(row => Object.values(row).map(val => 
                    typeof val === 'string' && val.includes(',') ? `"${val}"` : val
                ).join(','))
            ].join('\n');

            downloadFile(csvContent, `inventory_export_${new Date().toISOString().split('T')[0]}.csv`, 'text/csv');
        }

        function exportToJSON() {
            const jsonData = {
                exportDate: new Date().toISOString(),
                totalProducts: products.length,
                products: products
            };

            downloadFile(JSON.stringify(jsonData, null, 2), `inventory_backup_${new Date().toISOString().split('T')[0]}.json`, 'application/json');
        }

        function exportToExcel() {
            const worksheetData = products.map(product => ({
                ID: product.id,
                Name: product.name,
                SKU: product.sku,
                'Total Quantity': product.quantity,
                Price: product.price,
                'Available Quantity': getAvailableQuantity(product),
                'eBay Listed': product.platforms.ebay.listed ? 'Yes' : 'No',
                'eBay Quantity': product.platforms.ebay.quantity,
                'eBay Last Sync': product.platforms.ebay.lastSync || 'Never',
                'Etsy Listed': product.platforms.etsy.listed ? 'Yes' : 'No',
                'Etsy Quantity': product.platforms.etsy.quantity,
                'Etsy Last Sync': product.platforms.etsy.lastSync || 'Never',
                'Amazon Listed': product.platforms.amazon.listed ? 'Yes' : 'No',
                'Amazon Quantity': product.platforms.amazon.quantity,
                'Amazon Last Sync': product.platforms.amazon.lastSync || 'Never',
                'Shopify Listed': product.platforms.shopify.listed ? 'Yes' : 'No',
                'Shopify Quantity': product.platforms.shopify.quantity,
                'Shopify Last Sync': product.platforms.shopify.lastSync || 'Never'
            }));

            const worksheet = XLSX.utils.json_to_sheet(worksheetData);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, 'Inventory');
            
            XLSX.writeFile(workbook, `inventory_report_${new Date().toISOString().split('T')[0]}.xlsx`);
        }

        // Import functions
        function importFromJSON(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const jsonData = JSON.parse(e.target.result);
                        if (jsonData.products && Array.isArray(jsonData.products)) {
                            const existingSKUs = new Set(products.map(p => p.sku));
                            const newProducts = jsonData.products.filter(p => !existingSKUs.has(p.sku));
                            products.push(...newProducts);
                            saveData();
                            renderProducts();
                            alert(`Successfully imported ${newProducts.length} new products!`);
                        } else {
                            alert('Invalid JSON format. Please ensure the file contains a "products" array.');
                        }
                    } catch (error) {
                        alert('Error reading JSON file. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            }
            event.target.value = '';
        }

        function importFromCSV(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    try {
                        const csvText = e.target.result;
                        const lines = csvText.split('\n');
                        const headers = lines[0].split(',').map(h => h.trim().replace(/"/g, ''));
                        
                        const csvProducts = lines.slice(1).filter(line => line.trim()).map((line, index) => {
                            const values = line.split(',').map(v => v.trim().replace(/"/g, ''));
                            return {
                                id: Math.max(...products.map(p => p.id), 0) + index + 1,
                                name: values[headers.indexOf('Name')] || '',
                                sku: values[headers.indexOf('SKU')] || '',
                                quantity: parseInt(values[headers.indexOf('Total Quantity')]) || 0,
                                price: parseFloat(values[headers.indexOf('Price')]) || 0,
                                platforms: {
                                    ebay: { 
                                        listed: values[headers.indexOf('eBay Listed')] === 'Yes',
                                        quantity: parseInt(values[headers.indexOf('eBay Quantity')]) || 0,
                                        lastSync: values[headers.indexOf('eBay Last Sync')] !== 'Never' ? values[headers.indexOf('eBay Last Sync')] : null
                                    },
                                    etsy: { 
                                        listed: values[headers.indexOf('Etsy Listed')] === 'Yes',
                                        quantity: parseInt(values[headers.indexOf('Etsy Quantity')]) || 0,
                                        lastSync: values[headers.indexOf('Etsy Last Sync')] !== 'Never' ? values[headers.indexOf('Etsy Last Sync')] : null
                                    },
                                    amazon: { 
                                        listed: values[headers.indexOf('Amazon Listed')] === 'Yes',
                                        quantity: parseInt(values[headers.indexOf('Amazon Quantity')]) || 0,
                                        lastSync: values[headers.indexOf('Amazon Last Sync')] !== 'Never' ? values[headers.indexOf('Amazon Last Sync')] : null
                                    },
                                    shopify: { 
                                        listed: values[headers.indexOf('Shopify Listed')] === 'Yes',
                                        quantity: parseInt(values[headers.indexOf('Shopify Quantity')]) || 0,
                                        lastSync: values[headers.indexOf('Shopify Last Sync')] !== 'Never' ? values[headers.indexOf('Shopify Last Sync')] : null
                                    }
                                }
                            };
                        });

                        const existingSKUs = new Set(products.map(p => p.sku));
                        const newProducts = csvProducts.filter(p => p.name && p.sku && !existingSKUs.has(p.sku));
                        products.push(...newProducts);
                        saveData();
                        renderProducts();
                        alert(`Successfully imported ${newProducts.length} new products from CSV!`);
                    } catch (error) {
                        alert('Error reading CSV file. Please check the file format.');
                    }
                };
                reader.readAsText(file);
            }
            event.target.value = '';
        }

        // Utility function to download files
        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const link = document.createElement('a');
            const url = URL.createObjectURL(blob);
            link.setAttribute('href', url);
            link.setAttribute('download', filename);
            link.style.visibility = 'hidden';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }

        // Render products
        function renderProducts() {
            const container = document.getElementById('productsList');
            container.innerHTML = '';

            products.forEach(product => {
                const availableQty = getAvailableQuantity(product);
                
                const productElement = document.createElement('div');
                productElement.className = 'border rounded-lg p-6 hover:shadow-md transition-shadow';
                
                productElement.innerHTML = `
                    <div class="flex items-start justify-between mb-4">
                        <div class="flex-1">
                            <h3 class="text-xl font-semibold text-gray-900">${product.name}</h3>
                            <p class="text-gray-600">SKU: ${product.sku}</p>
                            <p class="text-green-600 font-medium">$${product.price.toFixed(2)}</p>
                        </div>
                        
                        <div class="flex items-center space-x-4">
                            <div class="text-right">
                                <div class="text-sm text-gray-500">Total Stock</div>
                                <div class="flex items-center space-x-2">
                                    <input type="number" value="${product.quantity}" 
                                           onchange="updateQuantity(${product.id}, parseInt(this.value) || 0)"
                                           class="w-20 text-center border rounded px-2 py-1 font-semibold">
                                    <svg class="w-4 h-4 text-gray-400" fill="currentColor" viewBox="0 0 24 24">
                                        <path d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2H5a2 2 0 00-2 2z"/>
                                        <path d="M8 5a2 2 0 012-2h4a2 2 0 012 2v2H8V5z"/>
                                    </svg>
                                </div>
                            </div>
                            
                            <div class="text-right">
                                <div class="text-sm text-gray-500">Available</div>
                                <div class="text-lg font-semibold ${availableQty < 0 ? 'text-red-600' : availableQty < 5 ? 'text-yellow-600' : 'text-green-600'}">
                                    ${availableQty}
                                </div>
                            </div>
                            
                            <button onclick="syncAllPlatforms(${product.id})" 
                                    class="bg-blue-600 text-white p-2 rounded-lg hover:bg-blue-700 transition-colors"
                                    title="Sync all platforms">
                                <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                                    <path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke="currentColor" stroke-width="2" fill="none"/>
                                </svg>
                            </button>
                        </div>
                    </div>

                    ${availableQty < 0 ? `
                    <div class="bg-red-50 border border-red-200 rounded-lg p-3 mb-4 flex items-center space-x-2">
                        <svg class="w-5 h-5 text-red-600" fill="currentColor" viewBox="0 0 24 24">
                            <path d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                        <span class="text-red-700 font-medium">Warning: Oversold by ${Math.abs(availableQty)} units</span>
                    </div>
                    ` : ''}

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        ${Object.entries(product.platforms).map(([platform, data]) => {
                            const syncKey = `${product.id}-${platform}`;
                            const currentSyncStatus = syncStatus[syncKey];
                            
                            return `
                                <div class="border rounded-lg p-4 bg-gray-50">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="flex items-center space-x-2">
                                            <span class="px-2 py-1 rounded text-xs font-medium ${platformColors[platform]} capitalize">${platform}</span>
                                            <label class="flex items-center space-x-1">
                                                <input type="checkbox" ${data.listed ? 'checked' : ''}
                                                       onchange="togglePlatformListing(${product.id}, '${platform}')"
                                                       class="rounded">
                                                <span class="text-xs text-gray-600">Listed</span>
                                            </label>
                                        </div>
                                        
                                        ${data.listed ? `
                                            <button onclick="syncToPlatform(${product.id}, '${platform}')"
                                                    ${currentSyncStatus === 'syncing' ? 'disabled' : ''}
                                                    class="p-1 rounded hover:bg-gray-200 transition-colors"
                                                    title="Sync to platform">
                                                ${currentSyncStatus === 'syncing' ? 
                                                    '<svg class="w-3 h-3 animate-spin text-blue-600" fill="currentColor" viewBox="0 0 24 24"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke="currentColor" stroke-width="2" fill="none"/></svg>' :
                                                currentSyncStatus === 'success' ? 
                                                    '<svg class="w-3 h-3 text-green-600" fill="currentColor" viewBox="0 0 24 24"><path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/></svg>' :
                                                    '<svg class="w-3 h-3 text-gray-400" fill="currentColor" viewBox="0 0 24 24"><path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke="currentColor" stroke-width="2" fill="none"/></svg>'
                                                }
                                            </button>
                                        ` : ''}
                                    </div>
                                    
                                    ${data.listed ? `
                                        <div class="space-y-2">
                                            <div class="flex items-center space-x-2">
                                                <span class="text-xs text-gray-500">Quantity:</span>
                                                <input type="number" value="${data.quantity}"
                                                       onchange="updatePlatformQuantity(${product.id}, '${platform}', parseInt(this.value) || 0)"
                                                       class="w-16 text-xs border rounded px-1 py-1"
                                                       min="0" max="${product.quantity}">
                                            </div>
                                            
                                            ${data.lastSync ? `
                                                <div class="text-xs text-gray-400">
                                                    Last sync: ${data.lastSync}
                                                </div>
                                            ` : ''}
                                        </div>
                                    ` : `
                                        <div class="text-xs text-gray-400 italic">
                                            Not listed on this platform
                                        </div>
                                    `}
                                </div>
                            `;
                        }).join('')}
                    </div>
                `;
                
                container.appendChild(productElement);
            });
        }

        // Initialize the app when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
        });
    </script>
</body>
</html>